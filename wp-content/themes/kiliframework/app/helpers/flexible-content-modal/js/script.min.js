(function(b){var c={init:function(){return'undefined'==typeof acf?(console.error('ACF JavaScript library not found!'),!1):void(acf.addAction('load_field/type=flexible_content',function(d){d.$el.find('.layout:not(.acf-clone):not(.fc-modal)').each(function(){var e=b(this);c.isNested(e)||c.addModal(e)}),b('.kiliframework').addClass('visible')}),acf.addAction('after_duplicate',function(d,e){e.is('.layout')&&!c.isNested(d)&&c.addModal(e)}),acf.addAction('append',function(d){d.is('.layout')&&d.find('> .acf-fc-layout-controls a.-pencil').trigger('click')}),acf.addAction('invalid_field',function(d){c.invalidField(d.$el)}),acf.addAction('valid_field',function(d){c.validField(d.$el)}))},isNested:function(d){return 1<d.parents('.acf-fields').length},addModal:function(d){d.addClass('fc-modal'),d.removeClass('-collapsed'),d.find('> .acf-fc-layout-handle').off('click'),d.find('> .acf-fc-layout-controls > a.-collapse').remove(),d.find('> .acf-fc-layout-controls > a.-plus').remove();var e=b('<a class="acf-icon -pencil small light" href="#" data-event="edit-layout" title="Edit layout" />');e.on('click',c.open),d.find('> .acf-fc-layout-controls').append(e),d.prepend('<div class="acf-fc-modal-title" />'),d.find('> .acf-fields, > .acf-table').wrapAll('<div class="acf-fc-modal-content" />')},open:function(){var d=b(this).parents('.layout'),e=d.find('> .acf-fc-layout-handle').html(),f=b('<a class="dashicons dashicons-no -cancel" />').on('click',c.close),g=b('<input name="save" type="submit" class="acf-button-update button" id="publish-kili" value="Update">');d.find('.acf-fc-modal-title').html(e).append(f).append(g),d.addClass('-modal'),b('body').append('<div id=\'acf-flexible-content-modal-overlay\' />'),b('#acf-flexible-content-modal-overlay').on('click',c.close),b('body').addClass('acf-modal-open')},close:function(){var d=b('.acf-flexible-content .layout.-modal'),e=d.parents('.acf-field-flexible-content');e=acf.getField(e.attr('data-key')),e.closeLayout(e.$layout(d.index())),b('body').removeClass('acf-modal-open'),b('.acf-flexible-content .layout').removeClass('-modal'),b('#acf-flexible-content-modal-overlay').remove()},invalidField:function(d){d.parents('.layout:not(.acf-clone)').addClass('layout-error-messages')},validField:function(d){d.parents('.layout:not(.acf-clone)').each(function(){var e=b(this);0==e.find('.acf-error').length&&e.removeClass('layout-error-messages')})}};c.init()})(jQuery);
